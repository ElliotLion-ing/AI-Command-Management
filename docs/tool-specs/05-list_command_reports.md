# Tool Specification: list_command_reports

## Overview

| Property | Value |
|----------|-------|
| **Tool Name** | `list_command_reports` |
| **Category** | Report Discovery |
| **Purpose** | List all reports generated by a specific command |

## Description

List all analysis reports that have been generated by a specific command. Returns report metadata sorted by date (newest first), useful for browsing historical analyses.

## Input Schema

```json
{
  "type": "object",
  "properties": {
    "command_name": {
      "type": "string",
      "description": "Name of the command to list reports for",
      "required": true,
      "examples": ["analyze_zoom_speech_sdk_log", "proxy-slow-meeting-analysis-command"]
    }
  },
  "required": ["command_name"]
}
```

## Output Schema

```json
{
  "type": "object",
  "properties": {
    "reports": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Report filename"
          },
          "date": {
            "type": "string",
            "format": "date-time",
            "description": "Report date (extracted from filename, or null)"
          },
          "size": {
            "type": "number",
            "description": "File size in bytes"
          },
          "link": {
            "type": "string",
            "description": "URL or file path to access the report (optional)"
          },
          "path": {
            "type": "string",
            "description": "Full file path to the report"
          }
        }
      }
    },
    "command_name": {
      "type": "string",
      "description": "The command name that was queried"
    },
    "total": {
      "type": "number",
      "description": "Total number of reports found"
    }
  }
}
```

## Implementation Requirements

### Core Logic

1. **Directory Resolution**
   - Report directory path: `{reports_directory}/{command_name}/`
   - Directory naming convention: use command name directly (no `-reports` suffix)

2. **File Discovery**
   - List all files in the command's report directory
   - Filter to `.md` files only
   - Handle case where directory doesn't exist (return empty array)

3. **Metadata Collection**
   For each report file:
   - Get filename
   - Extract date from filename
   - Get file size from stats
   - Generate link (if base URL configured)
   - Get full path

4. **Date Extraction Patterns**
   ```regex
   Pattern 1: /(\d{8})/           # YYYYMMDD
   Pattern 2: /(\d{4})[-_](\d{2})[-_](\d{2})/  # YYYY-MM-DD or YYYY_MM_DD
   ```

5. **Sorting**
   - Sort by date descending (newest first)
   - Reports without dates go to the end

### Directory Naming Convention

```
Reports Directory Structure:
{reports_directory}/
├── analyze_zoom_speech_sdk_log/
│   ├── report_20251120.md
│   └── report_20251125.md
├── proxy-slow-meeting-analysis-command/
│   ├── report_20251201.md
│   └── report_20251202.md
└── ... (other commands)
```

## Usage Examples

### Example 1: List Reports for Command
```json
// Input
{
  "command_name": "analyze_zoom_speech_sdk_log"
}

// Output
{
  "reports": [
    {
      "name": "analyze_zoom_speech_sdk_log_功能验证测试报告_20251126_141059_v1.md",
      "date": "2025-11-26T00:00:00.000Z",
      "size": 77,
      "link": "https://reports.example.com/analyze_zoom_speech_sdk_log/...",
      "path": "/opt/acmt/Commands-Analyze-Report/analyze_zoom_speech_sdk_log/..."
    },
    {
      "name": "Zoom_Speech_SDK_日志分析报告_20251120_decode_response_v6.md",
      "date": "2025-11-20T00:00:00.000Z",
      "size": 11179,
      "link": "https://reports.example.com/analyze_zoom_speech_sdk_log/...",
      "path": "/opt/acmt/Commands-Analyze-Report/analyze_zoom_speech_sdk_log/..."
    }
  ],
  "command_name": "analyze_zoom_speech_sdk_log",
  "total": 2
}
```

### Example 2: Command with No Reports
```json
// Input
{
  "command_name": "new_command_without_reports"
}

// Output
{
  "reports": [],
  "command_name": "new_command_without_reports",
  "total": 0
}
```

## Error Handling

| Error Code | Description | Resolution |
|------------|-------------|------------|
| `INVALID_COMMAND_NAME` | Command name contains invalid characters | Use alphanumeric, underscores, hyphens only |

**Note**: If the command's report directory doesn't exist, return empty array (not an error).

## Related Tools

- `search_reports`: Search report content across commands
- `get_report`: Get full content of a specific report
- `get_command`: Get the command definition


