# ACM 用户使用教程

> **本文档面向 ACM 系统的使用者，提供详细的操作指南和示例**

---

## 📖 目录

1. [什么是 ACM](#什么是-acm)
2. [快速开始](#快速开始)
3. [完整场景教程](#完整场景教程)
4. [命令提示语示例](#命令提示语示例)
5. [常见问题解答](#常见问题解答)
6. [最佳实践](#最佳实践)

---

## 什么是 ACM

**ACM (AI Command Management)** 是一个集中管理分析命令和报告的系统。它可以让你：

- 📁 **集中存储**分析命令，避免散落在各处
- 🔍 **快速搜索**需要的命令和历史报告
- 📤 **轻松上传**新的命令和分析报告
- 🌐 **Web 查看**所有已上传的内容

---

## 快速开始

### 第 1 步：配置 Cursor

在 Cursor 中添加 ACM 配置：

1. 打开配置文件：`~/.cursor/mcp.json`
2. 添加以下内容：

```json
{
  "mcpServers": {
    "acm": {
      "url": "https://zct-dev.zoomdev.us/sse",
      "transport": "sse"
    }
  }
}
```

3. **重启 Cursor**

### 第 2 步：验证配置

在 Cursor 中输入：

```
@acm 帮我列出所有可用的命令
```

如果看到命令列表，说明配置成功！

### 第 3 步：查看 Web 界面

打开浏览器访问：
- 开发环境：https://zct-dev.zoomdev.us/csp/aiCommandsManagement
- 生产环境：https://zct.zoomdev.us/csp/aiCommandsManagement

---

## 完整场景教程

### 场景 1：搜索并使用已有命令

**📌 需求**：想找一个分析 proxy 慢会议问题的命令

**🗣️ 用户输入**：
```
有没有分析 proxy 慢会议的工具？
```

**🤖 AI 响应示例**：
```
找到以下匹配的命令：

1. zNet-proxy-slow-meeting-join
   - 评分: 0.95
   - 描述: 分析 proxy 日志中的慢会议加入问题
   
是否需要查看详细内容？
```

**🗣️ 用户输入**：
```
是，显示 zNet-proxy-slow-meeting-join 的详细内容
```

**🤖 AI 响应**：
```
[显示完整的命令内容，包括分析步骤、注意事项等]
```

---

### 场景 2：上传一个新的主命令

**📌 需求**：创建一个新的日志分析命令

**步骤 1：创建命令文件**

创建文件 `ZMDB-error-log-analyze.md`：

```markdown
# ZMDB 错误日志分析

## 功能描述
分析 ZMDB 数据库的错误日志，识别常见错误模式。

## 使用步骤
1. 收集错误日志文件
2. 使用关键字搜索错误类型
3. 统计错误频率
4. 生成分析报告

## 注意事项
- 注意时区转换
- 过滤调试级别日志
```

**步骤 2：提示 AI 上传**

**🗣️ 用户输入**：
```
帮我上传 @ZMDB-error-log-analyze.md
```

**🤖 AI 响应**：
```
已读取文件内容。命令名称符合规范。

即将上传命令：
- 名称: ZMDB-error-log-analyze
- 版本: 0.0.1
- 所有者: your.email@zoom.us

是否继续上传？
```

**🗣️ 用户输入**：
```
是
```

**🤖 AI 响应**：
```
✅ 上传成功！

命令详情：
- 名称: ZMDB-error-log-analyze.md
- 版本: 0.0.1
- 路径: /Commands/ZMDB-error-log-analyze.md
- 数据库同步: 成功

你可以在 Web 界面查看：
https://zct-dev.zoomdev.us/csp/aiCommandsManagement
```

---

### 场景 3：上传主命令 + 子命令

**📌 需求**：创建一个复杂命令，包含主命令和两个辅助子命令

**步骤 1：创建主命令文件**

`zNet-meeting-quality-analyze.md`：
```markdown
# 会议质量分析

## 依赖
- [[zNet-network-metrics-extractor.md]]
- [[zNet-quality-threshold-checker.md]]

## 分析步骤
1. 使用网络指标提取器获取数据
2. 使用质量阈值检查器判断
3. 生成综合报告
```

**步骤 2：创建子命令文件 1**

`zNet-network-metrics-extractor.md`：
```markdown
---
is_dependency: true
---

# 网络指标提取器

## 提取规则
- 延迟: 从 RTT 字段提取
- 丢包率: 从 packet_loss 字段提取
- 带宽: 从 bandwidth 字段提取
```

**步骤 3：创建子命令文件 2**

`zNet-quality-threshold-checker.md`：
```markdown
---
is_dependency: true
---

# 质量阈值检查器

## 阈值定义
- 优秀: 延迟 < 50ms, 丢包率 < 0.1%
- 良好: 延迟 < 100ms, 丢包率 < 1%
- 较差: 延迟 >= 100ms 或 丢包率 >= 1%
```

**步骤 4：提示 AI 上传**

**🗣️ 用户输入**：
```
帮我上传主命令 @zNet-meeting-quality-analyze.md 和它的两个依赖文件 @zNet-network-metrics-extractor.md @zNet-quality-threshold-checker.md
```

**🤖 AI 响应**：
```
已读取 3 个文件：
- 主命令: zNet-meeting-quality-analyze.md
- 子命令 1: zNet-network-metrics-extractor.md (标记为依赖)
- 子命令 2: zNet-quality-threshold-checker.md (标记为依赖)

所有文件命名规范检查通过。

即将上传以下文件到 ACM：
1. zNet-network-metrics-extractor.md (belong_to: zNet-meeting-quality-analyze.md)
2. zNet-quality-threshold-checker.md (belong_to: zNet-meeting-quality-analyze.md)
3. zNet-meeting-quality-analyze.md (主命令)

是否继续？
```

**🗣️ 用户输入**：
```
是
```

**🤖 AI 响应**：
```
✅ 上传成功！

已上传文件：
1. ✅ zNet-network-metrics-extractor.md (子命令)
2. ✅ zNet-quality-threshold-checker.md (子命令)
3. ✅ zNet-meeting-quality-analyze.md (主命令)

所有文件数据库同步成功。
```

---

### 场景 4：上传分析报告

**📌 需求**：上传一个针对 proxy 问题的分析报告

**步骤 1：创建报告文件**

`proxy-slow-analysis-20251223.md`：
```markdown
# Proxy 慢会议问题分析报告

## 分析时间
2025-12-23 14:30

## 问题描述
用户反馈通过 proxy 加入会议时间过长（超过 10 秒）

## 根因分析
1. Proxy 线程池配置不当，线程数不足
2. DNS 解析超时导致连接延迟

## 解决方案
1. 增加 proxy 线程池大小至 200
2. 配置本地 DNS 缓存

## 验证结果
修改后加入时间降至 3 秒以内
```

**步骤 2：提示 AI 上传**

**🗣️ 用户输入**：
```
帮我上传这个分析报告 @proxy-slow-analysis-20251223.md，应该归档到 zNet-proxy-slow-meeting-join 命令下
```

**🤖 AI 响应**：
```
已读取报告内容。

找到匹配的命令文件夹: zNet-proxy-slow-meeting-join

即将上传报告：
- 报告名称: proxy-slow-analysis-20251223.md
- 目标命令: zNet-proxy-slow-meeting-join
- 所有者: your.email@zoom.us

是否继续上传？
```

**🗣️ 用户输入**：
```
是
```

**🤖 AI 响应**：
```
✅ 上传成功！

报告详情：
- 名称: zNet-proxy-slow-meeting-join_proxy-slow-analysis-20251223.md
- 路径: /Reports/zNet-proxy-slow-meeting-join/
- 数据库同步: 成功

你可以在 Web 界面的命令详情页查看此报告。
```

---

### 场景 5：使用模糊描述找到并执行命令

**📌 需求**：用户不知道具体命令名，只描述问题

#### 示例 5-1：分析日志问题

**🗣️ 用户输入（模糊描述）**：
```
我这边有个 proxy 的日志，会议加入特别慢，帮我分析一下
```

**🤖 AI 响应**：
```
我来帮你查找相关的分析工具。

找到匹配的命令：
1. zNet-proxy-slow-meeting-join (评分: 0.92)
   - 专门用于分析 proxy 慢会议加入问题

这个命令看起来非常适合你的场景。我来获取它的详细内容...

[显示命令内容]

根据这个命令，我们需要：
1. 首先识别 proxy 日志类型
2. 提取会议加入相关的时间线
3. 分析各阶段耗时

请提供你的 proxy 日志文件，我来帮你分析。
```

#### 示例 5-2：从现象到命令

**🗣️ 用户输入（模糊描述）**：
```
用户反馈语音通话有杂音，音质不好
```

**🤖 AI 响应**：
```
我来帮你找合适的分析工具。

找到以下相关命令：
1. SpeechSDK-audio-quality-analyze (评分: 0.88)
   - 分析音频质量问题
2. zNet-network-quality-check (评分: 0.75)
   - 检查网络质量影响

根据"语音通话杂音"的描述，推荐使用：
👉 SpeechSDK-audio-quality-analyze

我来获取这个命令的详细步骤...

[显示命令内容并开始执行]
```

#### 示例 5-3：关键词搜索

**🗣️ 用户输入（关键词）**：
```
数据库慢查询
```

**🤖 AI 响应**：
```
搜索"数据库慢查询"相关命令...

找到 2 个匹配命令：
1. ZMDB-slow-query-analyze (评分: 0.94)
   - 分析 ZMDB 慢查询日志
2. ZMDB-performance-diagnostic (评分: 0.82)
   - 数据库性能诊断

最匹配的是：ZMDB-slow-query-analyze

需要我获取这个命令的详细信息吗？
```

**🗣️ 用户输入**：
```
是
```

**🤖 AI 响应**：
```
[显示命令详细内容并询问是否需要帮助执行]
```

#### 示例 5-4：多个可能匹配

**🗣️ 用户输入（模糊描述）**：
```
分析一下这个错误日志
```

**🤖 AI 响应**：
```
我找到几个日志分析命令，请告诉我更多信息：

1. ZMDB-error-log-analyze - 数据库错误日志
2. zNet-proxy-log-analyze - Proxy 日志
3. SpeechSDK-log-analyze - Speech SDK 日志

请问是哪种类型的日志？或者你可以提供日志片段，我来判断。
```

**🗣️ 用户输入**：
```
是数据库的
```

**🤖 AI 响应**：
```
好的，使用 ZMDB-error-log-analyze 命令。

[显示命令内容并开始执行]
```

#### 示例 5-5：从报告反查命令

**🗣️ 用户输入（参考历史）**：
```
上次小明分析的那个 proxy 问题，我也遇到了
```

**🤖 AI 响应**：
```
我来查找小明之前的分析报告...

找到相关报告：
1. proxy-slow-analysis-20251220.md
   - 作者: ming.zhang@zoom.us
   - 命令: zNet-proxy-slow-meeting-join
   - 日期: 2025-12-20

这份报告使用的分析命令是：zNet-proxy-slow-meeting-join

我来获取这个命令的详细内容...

[显示命令内容]

你的问题是否也是会议加入慢的情况？
```

---

### 场景 6：查看历史报告

**📌 需求**：查看之前 Speech SDK 相关的分析报告

**🗣️ 用户输入**：
```
看看之前有什么 speech SDK 相关的分析报告
```

**🤖 AI 响应**：
```
找到 3 个相关报告：

1. SpeechSDK-decode-timeout-分析报告_20251120.md
   - 命令: SpeechSDK-log-analyze
   - 日期: 2025-11-20
   - 摘要: 解码超时问题根因分析

2. SpeechSDK-memory-leak-分析_20251118.md
   - 命令: SpeechSDK-log-analyze
   - 日期: 2025-11-18
   - 摘要: 内存泄漏问题定位

3. SpeechSDK-token-expired-报告_20251115.md
   - 命令: SpeechSDK-log-analyze
   - 日期: 2025-11-15
   - 摘要: Token 过期导致的服务异常

想查看哪个报告的详细内容？
```

**🗣️ 用户输入**：
```
显示第 1 个报告的内容
```

**🤖 AI 响应**：
```
[显示完整的报告内容]
```

---

## 模糊语句使用技巧

### 💡 技巧 1：描述问题现象

不需要知道命令名，直接描述问题：

| 模糊描述 | AI 能理解的含义 | 匹配到的命令 |
|---------|----------------|-------------|
| "会议加入很慢" | 会议性能问题 | zNet-proxy-slow-meeting-join |
| "语音有杂音" | 音频质量问题 | SpeechSDK-audio-quality-analyze |
| "数据库查询慢" | 数据库性能 | ZMDB-slow-query-analyze |
| "内存占用高" | 内存泄漏问题 | Memory-leak-diagnostic |

### 💡 技巧 2：使用关键词组合

| 关键词组合 | 搜索策略 | 示例 |
|-----------|---------|------|
| "日志 + 错误" | 错误日志分析 | "分析错误日志" |
| "网络 + 质量" | 网络质量检测 | "检查网络质量" |
| "性能 + 慢" | 性能问题诊断 | "性能慢怎么办" |
| "崩溃 + 分析" | 崩溃日志分析 | "分析崩溃原因" |

### 💡 技巧 3：参考他人的分析

```
# 通过作者查找
"小明上次分析的那个问题"
"张三做过类似的分析"

# 通过时间查找
"上周的那个 proxy 分析"
"最近有没有类似的报告"

# 通过问题类型查找
"之前有人分析过会议加入慢的问题吗"
```

### 💡 技巧 4：逐步细化

```
用户: "分析日志"
AI: "请问是哪种类型的日志？"

用户: "数据库的"
AI: "使用 ZMDB-error-log-analyze..."

用户: "慢查询的"
AI: "更换为 ZMDB-slow-query-analyze..."
```

---

## 命令提示语示例

### 搜索相关

```
# 搜索命令 - 精确方式
有没有分析 XXX 的工具？
找一个处理 YYY 问题的命令
搜索所有与 ZZZ 相关的命令

# 搜索命令 - 模糊方式（推荐）
会议加入特别慢，帮我看看
用户反馈语音有杂音
这个数据库查询很慢
内存占用一直在涨

# 查看命令
显示 [命令名] 的详细内容
获取 [命令名] 的完整定义
列出所有可用的命令
```

### 上传相关

```
# 上传主命令
帮我上传 @MyCommand.md
上传这个命令文件 @xxx.md

# 上传主命令+子命令
帮我上传主命令 @Main.md 和它的依赖文件 @Dep1.md @Dep2.md
上传 @Main.md，它依赖 @Helper.md

# 上传报告
帮我上传这个分析报告 @report.md
上传报告 @analysis.md 到 [命令名] 命令下
```

### 查询相关

```
# 查看报告 - 精确方式
列出 [命令名] 的所有报告
显示报告 [报告名] 的内容

# 查看报告 - 模糊方式（推荐）
看看之前有什么 XXX 的分析报告
上次小明分析的那个问题
最近有没有类似的案例
有人遇到过这种情况吗

# 更新命令
更新命令 [命令名] 的内容
升级 [命令名] 到新版本
```

---

## 常见问题解答

### Q1: 我的命令文件名不符合规范怎么办？

**A**: AI 会自动检测并提示你。例如：

```
❌ 检测到命名不符合规范

你的文件名: proxy-slow-analysis.md
问题: 缺少 Module 前缀

建议使用: zNet-proxy-slow-analysis.md

是否同意使用建议的名称？
```

你可以选择：
- 回复 "是" → AI 使用建议名称上传
- 回复 "否" → 取消上传，你手动修改文件名

---

### Q2: 如何知道文件是主命令还是子命令？

**A**: 通过文件开头的 frontmatter 判断：

| 文件类型 | 标记 |
|---------|------|
| **主命令** | 无需特殊标记，直接写 markdown |
| **子命令** | 必须在开头添加 `---`<br>`is_dependency: true`<br>`---` |

---

### Q3: 子命令忘记添加标记会怎样？

**A**: 会被识别为主命令，导致：
- 无法建立正确的依赖关系
- 在 Web 界面中显示为独立命令
- 主命令引用失效

**解决方法**：重新添加标记后再上传。

---

### Q4: 报告可以上传到自定义文件夹吗？

**A**: 不可以。报告只能上传到**已存在的命令文件夹**下。

**原因**：报告和命令是一对多关系，每个报告必须归属于某个命令。

**正确做法**：
1. 先确定报告应该归属哪个命令
2. 告诉 AI 上传到该命令下
3. 如果命令不存在，先创建命令

---

### Q5: 邮箱需要手动输入吗？

**A**: 不需要。AI 会自动从 Cursor 获取你的登录邮箱。

只有在以下情况才会询问你：
- Cursor 未登录
- 无法读取邮箱信息
- 邮箱格式无效

---

### Q6: 上传后发现内容有误，如何修改？

**A**: 有两种方式：

**方式 1：更新命令**
```
更新命令 [命令名] 的内容，使用 @NewVersion.md
```

AI 会询问版本更新类型（patch/minor/major）。

**方式 2：Web 界面**
在 Web 管理界面中找到命令，点击"编辑"按钮修改。

---

### Q7: 如何组织复杂的命令结构？

**A**: 使用主命令+子命令模式：

```
主命令（用户直接使用）
  ├─ 子命令 1（辅助逻辑）
  ├─ 子命令 2（辅助逻辑）
  └─ 子命令 3（辅助逻辑）
```

**优势**：
- 逻辑清晰，易于维护
- 子命令可复用
- Web 界面只显示主命令，避免混乱

---

## 最佳实践

### 📝 命名规范

```
✅ 好的命名
zNet-proxy-slow-meeting-join.md
ZMDB-error-log-analyze.md
SpeechSDK-decode-timeout-check.md

❌ 不好的命名
proxy-analyze.md               (缺少 Module)
Tool-code review.md            (包含空格)
zNet-proxy-command.md          (冗余后缀)
```

### 📁 文件组织

```
主命令：
✅ 独立功能，用户直接使用
✅ 引用子命令获得辅助信息
✅ 包含完整的使用说明

子命令：
✅ 提供辅助逻辑和规则
✅ 可被多个主命令引用
✅ 开头必须有 is_dependency: true
```

### 📊 报告撰写

```
✅ 好的报告结构
1. 问题描述（现象、影响范围）
2. 数据分析（日志、指标、截图）
3. 根因定位（技术细节）
4. 解决方案（具体步骤）
5. 验证结果（效果对比）

❌ 避免
- 缺少时间信息
- 结论不明确
- 缺少数据支撑
```

### 🔄 版本管理

```
0.0.1 → 0.0.2  (patch: 小修复、文档更新)
0.0.1 → 0.1.0  (minor: 新增功能、重要优化)
0.0.1 → 1.0.0  (major: 重大变更、不兼容更新)
```

---

## 快速参考卡片

### 命令文件规范

| 项目 | 要求 |
|------|------|
| **文件名** | `{Module}-xx-yy-zz.md` |
| **版本** | 新建从 `0.0.1` 开始 |
| **主命令** | 普通 markdown，无需特殊标记 |
| **子命令** | 开头添加 `is_dependency: true` |

### 上传流程

| 步骤 | 操作 |
|------|------|
| 1 | 准备符合规范的文件 |
| 2 | 告诉 AI 上传 |
| 3 | AI 检查命名和内容 |
| 4 | AI 询问确认 |
| 5 | 用户确认后上传 |

### 常用提示语

| 场景 | 提示语 |
|------|--------|
| 搜索 | "有没有分析 XXX 的工具？" |
| 查看 | "显示 [命令名] 的详细内容" |
| 上传命令 | "帮我上传 @MyCommand.md" |
| 上传报告 | "上传报告 @xxx.md 到 [命令] 下" |
| 查历史 | "看看 [命令] 的历史报告" |

---

**文档版本**: 0.5.1  
**最后更新**: 2025-12-23  
**适用环境**: 开发环境 / 生产环境

